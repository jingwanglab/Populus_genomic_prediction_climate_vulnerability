#!/bin/bash
set -e
indir="/w/00/g/g00/sangyupeng/xiangyang/bwa_mem"
dup_dir="/w/00/g/g00/sangyupeng/xiangyang/picard"
outfile="/w/00/g/g00/sangyupeng/xiangyang/information.txt"
echo "sample	mapped_ratio	properly.paired_ratio	percent_duplication" > $outfile
for file in $indir/*/*.stat
do
	temp=${file##*/}
	sample=${temp%%.*}
	mr=`cat $file | grep "0 mapped" | cut -d '(' -f 2 | cut -d ':' -f 1`
	pr=`cat $file | grep "0 properly paired" | cut -d '(' -f 2 | cut -d ':' -f 1`
	dir=${sample%-*}
	dupfile=$dup_dir/$dir/$sample.metrics
#提取.metrics 第八行第九列
	dup=`cat $dupfile | awk '{print $9}' | sed -n '8p'`
	echo "$sample	$mr	$pr	$dup" >> $outfile
done
