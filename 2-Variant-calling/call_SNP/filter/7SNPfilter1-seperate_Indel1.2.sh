#!/bin/bash
set -e
snp_dir="/w/00/g/g00/sangyupeng/xiangyang/filter/snp"
snp_annote_dir="/w/00/g/g00/sangyupeng/xiangyang/filter/snp_annote"
mark_dir="/w/00/g/g00/sangyupeng/xiangyang/filter/remove_indel_mark"
outdir="/w/00/g/g00/sangyupeng/xiangyang/filter/final_remove_indel_snp"
rawsnp_sites_dir="/w/00/g/g00/sangyupeng/xiangyang/filter/sites/rawsnp"
mark_sites_dir="/w/00/g/g00/sangyupeng/xiangyang/filter/sites/remove"
keepsnp_sites_dir="/w/00/g/g00/sangyupeng/xiangyang/filter/snp_annote/keep_sites"
#create remove_sites_file
if [ ! -d $mark_sites_dir ];then
mkdir $mark_sites_dir
fi 
for mark_file in $mark_dir/*.gz
do
	temp=${mark_file##*/}
	chr=${temp%234.*}remove.txt
	zcat $mark_file | awk '{print $1":"$2}' > $mark_sites_dir/$chr
done

#create rawsnp_sites_file
if [ ! -d $rawsnp_sites_dir ];then
mkdir $rawsnp_sites_dir
fi
for snp_file in $snp_dir/*.gz
do
	temp=${snp_file##*/}
	chr=${temp%%234.*}rawsites.txt
	zcat $snp_file | awk '{print $1":"$2}' > $rawsnp_sites_dir/$chr
done

#create keep_sites_file	
if [ ! -d $keepsnp_sites_dir ];then
mkdir $keepsnp_sites_dir
fi
for rawsites_file in $rawsnp_sites_dir/*.txt
do
	temp=${rawsites_file##*/}
	chr=${temp%%rawsites.*}remove.txt
	keep_sitesfile=${temp%%rawsites.*}keep.txt
	sort $rawsites_file $mark_sites_dir/$chr $mark_sites_dir/$chr | uniq -u | grep -v "#" | sort -t : -k 1,1 -k 2n > $keepsnp_sites_dir/$keep_sitesfile
done

