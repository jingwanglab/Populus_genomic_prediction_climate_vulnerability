#!/bin/bash
set -e
indir="/w/00/g/g00/sangyupeng/xiangyang/GATK_vcf"
outdir_indel="/w/00/g/g00/sangyupeng/xiangyang/filter/indel"
outdir_mark="/w/00/g/g00/sangyupeng/xiangyang/filter/remove_indel_mark"
outdir_snp="/w/00/g/g00/sangyupeng/xiangyang/filter/snp"
VCFTOOLS="/data/apps/vcftools/vcftools-0.1.15/bin"
PIGZ="/w/00/u/user201/software/pigz-2.4"
TABIX="/w/00/u/user201/software/tabix-0.2.6"
BEDTOOLS="/data/apps/bedtools/bedtools-2.26.0/bin"
for vcf in $indir/*.vcf.gz
do
	temp=${vcf##*/}
	snp=${temp%v*}snp
	outfile_snp=${temp%v*}snp.recode.vcf
	indel=${temp%v*}indel
	outfile_indel=${temp%v*}indel.recode.vcf
	b=${temp%v*}indel.recode.vcf.gz
	outfile_mark=${temp%v*}rm_indel_mark.vcf
	echo "cd $outdir_snp;$VCFTOOLS/vcftools --gzvcf $vcf --remove-indels --maf 0.0000001 --recode --recode-INFO-all --out $snp;$PIGZ/pigz $outfile_snp;cd $outdir_indel;$VCFTOOLS/vcftools --gzvcf $vcf --keep-only-indels --maf 0.0000001 --recode --recode-INFO-all --out $indel;$PIGZ/pigz $outfile_indel;cd $outdir_mark;$BEDTOOLS/bedtools window -header -a $vcf -b $outdir_indel/$b -w 5 -u > $outfile_mark;$TABIX/bgzip $outfile_mark" >> 12.filter_1.sh 
done
