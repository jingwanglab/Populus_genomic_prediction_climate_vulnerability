#!/bin/bash
set -e
Outdir="/w/00/g/g00/sangyupeng/xiangyang/SV/delly"
Indir="/w/00/g/g00/sangyupeng/xiangyang/picard"
reference="/w/00/g/g00/sangyupeng/xiangyang/reference/zsp193a-LH.LG.fasta"
bcftools="/data/apps/bcftools/1.9/bin/bcftools"
sh_file="/w/00/u/user201/pk_SV_delly.sh"
delly="/w/00/u/user201/software/delly/src/delly"
for dir in $Indir/*
do
        for bam_file in $dir/*.bam
        do
                temp=${bam_file##*/}
                sample=${temp%%.*}
                pop=${temp%-*}
                if [ ! -d "$Outdir/$pop" ]; then
                mkdir -p $Outdir/$pop
                fi
                echo "cd $Outdir/$pop;$delly call -g $reference -o $Outdir/$pop/$sample.bcf $bam_file" >> $sh_file
        done
done
