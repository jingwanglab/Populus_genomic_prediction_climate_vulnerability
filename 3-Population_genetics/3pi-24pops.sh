#!/bin/bash
set -e
inputdir="/w/00/g/g00/sangyupeng/xiangyang/final_vcf/dxy_pi_newfilter"
OUTDIR_pi="/w/00/g/g00/sangyupeng/xiangyang/final_vcf/pi/pi_value"
OUTDIR_pizarr="/w/00/g/g00/sangyupeng/xiangyang/final_vcf/pi/zarr"
outfile="/w/00/u/user201/pk_pidxy.sh"
#create pi_outdir
for vcf in $inputdir/*.gz
do
	temp1=${vcf##*/}
	chr=${temp1%%.rmindel*}
	chr_zarr=${temp1%%.rmindel*}_zarr
	chr_value=${temp1%%.rmindel*}_value
	outdir_pizarr=$OUTDIR_pizarr/$chr_zarr
	outdir_pivalue=$OUTDIR_pi/$chr_value
	if [ ! -d "$outdir_pizarr" ]; then
	mkdir -p $outdir_pizarr
	fi
	if [ ! -d "$outdir_pivalue" ]; then
	mkdir -p $outdir_pivalue
        fi
	temp2=$outdir_pivalue
	out_pi=${temp2%_*}_value/PK_230_$chr.pi
	echo "/w/00/g/g00/sangyupeng/conda/envs/pixy/bin/pixy --stats pi --vcf $vcf --zarr_path $outdir_pizarr --window_size 10000 --populations /w/00/g/g00/sangyupeng/xiangyang/final_vcf/pop/PK_pop.txt --bypass_filtration yes --outfile_prefix $out_pi" >> $outfile
done

